    {% extends 'department/master.html' %}
    {% block head %}

    <!--<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    -->
    <style>

      form {
      width: 80%;
      padding: 20px;
      border-radius: 3px;
      background: #fff;
      box-shadow: 0 0 20px 0 #a82877;
      margin: 0 auto;
      margin-bottom: 10px;
      }

      input,select {
      margin-bottom: 5px;
      border: 1px solid #ccc;
      border-radius: 1px;
      }
      input {
      width: calc(50% - 10px);
      padding: 5px;
      }
      select {
      width: 50%;
      padding: 7px 0;
      background: transparent;
      }
      textarea {
      width: calc(100% - 12px);
      padding: 5px;
      }
      .item1:hover p, .item1:hover i, .question:hover p, .question label:hover, input:hover::placeholder {
      color: #a82877;
      }

      .item1 input:hover, .item1 select:hover, .item1 textarea:hover {
      border: 1px solid transparent;
      box-shadow: 0 0 6px 0 #a82877;
      color: #a82877;
      }
      .item1 {
      position: relative;
      margin: 10px 0;
      }
      input[type="date"]::-webkit-inner-spin-button {
      display: none;
      }
      .item1 i, input[type="date"]::-webkit-calendar-picker-indicator {
      position: absolute;
      font-size: 20px;
      color: #a9a9a9;
      }
      .item1 i {
      right: 1%;
      top: 30px;
      z-index: 1;
      }
      [type="date"]::-webkit-calendar-picker-indicator {
      right: 50;
      z-index: 2;
      opacity: 0;
      cursor: pointer;
      }
      input[type="time"]::-webkit-inner-spin-button {
      margin: 2px 22px 0 0;
      }
      input[type=radio], input.other {
      display: none;
      }
      label.radio {
      position: relative;
      display: inline-block;
      margin: 5px 20px 10px 0;
      cursor: pointer;
      }
      .question span {
      margin-left: 30px;
      }
      label.radio:before {
      content: "";
      position: absolute;
      top: 2px;
      left: 0;
      width: 15px;
      height: 15px;
      border-radius: 50%;
      border: 2px solid #ccc;
      }
      #radio_5:checked ~ input.other {
      display: block;
      }
      input[type=radio]:checked + label.radio:before {
      border: 2px solid #a82877;
      background: #a82877;
      }
      label.radio:after {
      content: "";
      position: absolute;
      top: 7px;
      left: 5px;
      width: 7px;
      height: 4px;
      border: 3px solid #fff;
      border-top: none;
      border-right: none;
      transform: rotate(-45deg);
      opacity: 0;
      }
      input[type=radio]:checked + label:after {
      opacity: 1;
      }
      .btn-block {
      margin-top: 10px;
      text-align: center;
      }
      button {
      width: 150px;
      padding: 10px;
      border: none;
      border-radius: 5px;
      background: #a82877;
      font-size: 16px;
      color: #fff;
      cursor: pointer;
      }
      button:hover {
      background: #bf1e81;
      }
      @media (min-width: 568px) {
      .name-item1, .city-item1 {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      }
      .name-item1 input, .city-item1 input {
      width: calc(50% - 20px);
      }
      .city-item1 select {
      width: calc(50% - 8px);
      }
      }
    </style>
     {% endblock %}

    {% block section %}<br>
      <form id="form1" method="POST">
        {% csrf_token %}
        <div class="item1">
          <h1 size=10 style="color:blue">Student Registration - Add Basic Info</h1>
        </div>

          <div class="item1">
          <!--<div class="name-item1">-->
              <p>First Name</p>
            <input type="text" name="fname" id="fname" required/>
             <br><span id="spnfnameStatus"></span>
              <p>Middle Name</p>
            <input type="text" name="mname" id="mname">
             <br><span id="spnmnameStatus"></span>
              <p>Last Name</p>
            <input type="text" name="lname" id="lname" required/>
             <br><span id="spnlnameStatus"></span>
          </div>

          <div class="question">
          <p>Gender</p>
          <div class="question-answer">
            <div>
              <input type="radio" value="M" id="radio_1" name="gen" />
              <label for="radio_1" class="radio"><span>Male</span></label>
            </div>
            <div>
              <input type="radio" value="F" id="radio_2" name="gen" />
              <label for="radio_2" class="radio"><span>Female</span></label>
            </div>
          </div>
        </div>
        <span id="spngenderStatus"></span>
          <div class="item1">
              <p>Course</p>
          <select id="cr" name="cr">
            <option value="course-type" selected>Select</option>
              {% if courses %}
                {% for course in courses %}
                    <option value={{ course.course_id }}>{{ course.course_name }}</option>
                {% endfor %}
              {% endif %}
          </select>
              <br><span id="spncourseStatus"></span>
              </div>

        <div class="item1">
          <p>Start Date</p>
          <input type="date" name="startdate" id="startdate" disabled required/>
          <i class="fas fa-calendar-alt"></i>
            <br><span id="spnstartdateStatus"></span>
        </div>

          <div class="item1">
          <p>End Date</p>
          <input type="date" name="enddate" id="enddate" disabled required/>
          <i class="fas fa-calendar-alt"></i>
              <br><span id="spnenddateStatus"></span>
        </div>

          <div class="item1">
          <!--<div class="name-item1">-->
              <p>Email</p>
            <input type="text" name="email" id="email" required/>
              <br><span id="spnemailStatus"></span>

          </div>

    </div><br>
        <div class="btn-block">
          <button type="submit" id="formSubmit" onclick="">Send</button>
        </div>
      </form>
    {% endblock %}

    {% block script %}
<script type='text/javascript'>
 "{% if not messages %}"
    $(function() {
        $(document).scrollTop($("#dataForm").offset().top);
    });
    "{% endif %}"
    $(window).load(function() {
        $(document).ready(function() {

            $('#radio_1').click(function(e){
                    $('#spngenderStatus').html('');
                    $('#spngenderStatus').css('color', 'red');
            });

            $('#radio_2').click(function(e){
                    $('#spngenderStatus').html('');
                    $('#spngenderStatus').css('color', 'red');
            });

            $('#cr').change(function(e){
                if($('#cr').val()!='course-type'){
                    $('#spncourseStatus').html('');
                    $('#spncourseStatus').css('color', 'red');
                    document.getElementById('startdate').disabled =false;
                    $('#startdate').val('');
                    $('#enddate').val('');
                }
                else{
                    $('#spncourseStatus').html('Choose course');
                    $('#spncourseStatus').css('color', 'red');
                    document.getElementById('enddate').disabled =true;
                    document.getElementById('startdate').disabled =true;
                    $('#startdate').val('');
                    $('#enddate').val('');
                }
            });


            $('#email').blur(function (e) {
                if (IsEmail('email')) {
                    $('#spnemailStatus').html('Valid Email');
                    $('#spnemailStatus').css('color', 'green');
                } else {
                    $('#spnemailStatus').html('Invalid Email');
                    $('#spnemailStatus').css('color', 'red');

                }
            });

            $('#fname').blur(function (e) {

                if (validateName('fname')) {
                    $('#spnfnameStatus').html('Valid Name');
                    $('#spnfnameStatus').css('color', 'green');
                } else {
                    $('#spnfnameStatus').html('Invalid First Name');
                    $('#spnfnameStatus').css('color', 'red');

                }
            });

            $('#mname').blur(function (e) {

                if ($('#mname').val()) {
                    if (validateName('mname')) {
                        $('#spnmnameStatus').html('Valid Middle Name');
                        $('#spnmnameStatus').css('color', 'green');
                    } else {
                        $('#spnmnameStatus').html('Invalid Middle Name');
                        $('#spnmnameStatus').css('color', 'red');

                    }
                }
                else {
                    $('#spnmnameStatus').html('');

                }

            });

            $('#startdate').change(function(e) {
                document.getElementById('enddate').disabled =false;
                changenomWithDate($('#startdate').val());
                $('#spnstartdateStatus').html('');

            });     //end of Dt change

            $('#enddate').change(function(e) {
                $('#spnenddateStatus').html('');

            });     //end of Dt change

            $('#lname').blur(function (e) {

                if (validateName('lname')) {
                    $('#spnlnameStatus').html('Valid Last Name');
                    $('#spnlnameStatus').css('color', 'green');
                } else {
                    $('#spnlnameStatus').html('Invalid Last Name');
                    $('#spnlnameStatus').css('color', 'red');

                }
            });

            $('#formSubmit').click(function(e) {
                e.preventDefault();
                flag = 1;
                $.ajax({
                    url: 'validate_addstud/',
                    data: {

                        'email': $('#email').val()
                    },
                    dataType: 'json',
                    success: function(data) {
                        if (data.dmail_status) {
                            $('#spnemailStatus').html('Email exists');
                            $('#spnemailStatus').css('color', 'red');
                            flag = 0;
                        }

                        if(flag==1)
                            $('#form1').submit();
                    }
                });

                if(!(radio_1.checked) && !(radio_2.checked))
                {
                    $('#spngenderStatus').html('Choose gender');
                    $('#spngenderStatus').css('color', 'red');
                    var flag = 0;
                }
                if($('#cr').val()=='course-type')
                {
                    $('#spncourseStatus').html('Choose course');
                    $('#spncourseStatus').css('color', 'red');
                    var flag = 0;
                }

                if($('#startdate').val()==''){
                    $('#spnstartdateStatus').html('Choose joining date');
                    $('#spnstartdateStatus').css('color', 'red');
                    var flag = 0;
                }


                if($('#enddate').val()==''){
                    $('#spnenddateStatus').html('Choose course end date');
                    $('#spnenddateStatus').css('color', 'red');
                    var flag = 0;
                }



                if (IsEmail('email') == false) {
                    $('#spnemailStatus').html('Invalid Email');
                    $('#spnemailStatus').css('color', 'red');
                    var flag = 0;
                }

                if (validateName('fname')) {
                    //
                } else {
                    $('#spnfnameStatus').html('Invalid  First Name');
                    $('#spnfnameStatus').css('color', 'red');
                    var flag = 0;

                }
                if ($('#mname').val()) {
                    if (validateName('mname')) {
                        //
                    } else {
                        $('#spnmnameStatus').html('Invalid Middle Name');
                        $('#spnmnameStatus').css('color', 'red');
                        var flag = 0;

                    }
                }



                if (validateName('lname')) {
                    //
                } else {
                    $('#spnlnameStatus').html('Invalid Last Name');
                    $('#spnlnameStatus').css('color', 'red');
                    var flag = 0;

                }

                if (flag == 0) {
                    return false;
                }

            });
        });

        function IsEmail(email) {
            var a = document.getElementById(email).value;
            var regex = /^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
            if (!regex.test(a)) {
                return false;
            } else {
                return true;
            }
        }
        function validateName(name) {
            var a = document.getElementById(name).value;
            var filter = /^[a-zA-Z]+$/;
            if (filter.test(a)) {
                return true;
            } else {
                return false;
            }
        }

        function changenomWithDate(newdate){

                $('#enddate').val('');
                var today = new Date(newdate);
                a = $('#cr').val();
                if(a !='course-type'){
                    "{% if courses %}"
                        "{% for course in courses %}"
                            if (a=="{{ course.course_id }}"){
                                dur = "{{ course.duration}}";
                            }
                        "{% endfor %}"
                    "{% endif %}"
                    dur = parseInt(dur);
                    today.setFullYear(today.getFullYear() + dur );
                    today = today.toISOString().split('T')[0];
                    document.getElementsByName("enddate")[0].setAttribute('min', today);
                }

            }

    });
</script>

{% endblock %}

